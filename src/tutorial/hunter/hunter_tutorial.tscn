[gd_scene format=3 uid="uid://dguyyy188ihbi"]

[ext_resource type="PackedScene" uid="uid://c64tx6254qrlp" path="res://src/tutorial/tutorial.tscn" id="1_c5qxs"]
[ext_resource type="Script" uid="uid://c34s5yn38nab1" path="res://src/tutorial/hunter/hunter_tutorial.gd" id="2_v1ay4"]
[ext_resource type="PackedScene" uid="uid://8qwvhkjp3yja" path="res://src/tutorial/quest/wpm_complete/wpm_complete.tscn" id="3_0femm"]
[ext_resource type="Script" uid="uid://bcveuhp3crl7q" path="res://src/tutorial/quest/quest.gd" id="3_ea8sw"]
[ext_resource type="PackedScene" uid="uid://bu4oleqx87mnw" path="res://src/tutorial/quest/complete_after_delay/complete_after_delay.tscn" id="4_dj2kv"]
[ext_resource type="Script" uid="uid://b6ajv1ch780ws" path="res://src/tutorial/quest/composite_quest.gd" id="4_e5msw"]
[ext_resource type="Script" uid="uid://le5w1cm0ul8p" path="res://addons/godot_state_charts/expression_guard.gd" id="4_mx0qj"]
[ext_resource type="Script" uid="uid://dgd4i8hrrxfvm" path="res://addons/godot_state_charts/not_guard.gd" id="5_h1wiw"]
[ext_resource type="Script" uid="uid://bghayfahpoh8d" path="res://src/tutorial/quest/quest_node.gd" id="5_sx67b"]
[ext_resource type="Shader" uid="uid://d2i6fyt1j8hb8" path="res://addons/shaders/palette_swap.gdshader" id="6_6k6h6"]
[ext_resource type="PackedScene" uid="uid://c5r0sjcdbsrog" path="res://src/controller/npc_ghost/npc_ghost.tscn" id="6_n7jug"]
[ext_resource type="Texture2D" uid="uid://b1r4xdhw8pco3" path="res://assets/hunter/palettes/yellow.png" id="7_k04wc"]
[ext_resource type="PackedScene" uid="uid://ccvsw508kh4ot" path="res://src/hunter/hunter.tscn" id="7_smdw1"]
[ext_resource type="PackedScene" uid="uid://di5qxwdvv5nga" path="res://src/controller/npc_hunter/npc_hunter.tscn" id="8_40hbx"]
[ext_resource type="PackedScene" uid="uid://grxm3658ukjj" path="res://src/battery_spawner/battery_spawner.tscn" id="13_g4mwu"]
[ext_resource type="Texture2D" uid="uid://df1deb6rjs1kc" path="res://assets/hunter/palettes/placeholder.png" id="13_k4uj5"]
[ext_resource type="Texture2D" uid="uid://7re8oqadq4as" path="res://assets/hunter/party_hat/palettes/green.png" id="14_xh0tf"]

[sub_resource type="Resource" id="Resource_7jipr"]
resource_name = "Battery"
script = ExtResource("3_ea8sw")
objective = "A battery spawns at a random location for each hunter in need. Try picking one up to recharge your flashlight."

[sub_resource type="Resource" id="Resource_26eav"]
resource_name = "Welcome"
script = ExtResource("3_ea8sw")
objective = "Welcome to the [pulse freq=2.0 color=#ffeb57 ease=-2.0]hunter[/pulse] tutorial."

[sub_resource type="Resource" id="Resource_f0tmj"]
resource_name = "Move"
script = ExtResource("3_ea8sw")
objective = "First, try moving around."

[sub_resource type="Resource" id="Resource_y74n0"]
resource_name = "Light"
script = ExtResource("3_ea8sw")
objective = "Now try powering on your light. You move slower while it is powered."

[sub_resource type="Resource" id="Resource_hsvyu"]
resource_name = "AlertInfo"
script = ExtResource("3_ea8sw")
objective = "You are alerted when the ghost is near, even if you can't see it. The [wave amp=20.0 freq=5.0 connected=0][color=#ff0040]...[/color][/wave] above your head is for low alert; the [pulse freq=4.0 color=#571c27 ease=-2.0][color=#ff0040]![/color][/pulse] is high alert.
"

[sub_resource type="Resource" id="Resource_blp0j"]
resource_name = "AlertLow"
script = ExtResource("3_ea8sw")
objective = "Try moving to put yourself in low (...) alert."

[sub_resource type="Resource" id="Resource_huau8"]
resource_name = "AlertHigh"
script = ExtResource("3_ea8sw")
objective = "Try moving to put yourself in high (!) alert."

[sub_resource type="Resource" id="Resource_pl133"]
resource_name = "Alert"
script = ExtResource("4_e5msw")
sub_quests = Array[ExtResource("3_ea8sw")]([SubResource("Resource_blp0j"), SubResource("Resource_huau8")])
objective = "Try moving to put yourself in both low ([wave amp=20.0 freq=5.0 connected=0][color=#ff0040]...[/color][/wave]) and high ([pulse freq=4.0 color=#571c27 ease=-2.0][color=#ff0040]![/color][/pulse]) alert."

[sub_resource type="Resource" id="Resource_04vwp"]
resource_name = "Damage"
script = ExtResource("3_ea8sw")
objective = "Your goal is to kill the ghost by shining your light on it. Try using your alert to find the ghost, then hit it with your light."

[sub_resource type="Resource" id="Resource_s3q2n"]
resource_name = "Summon"
script = ExtResource("3_ea8sw")
objective = "The ghost can summon drain areas to deplete your battery and destroy all batteries on the map. Try getting hit by one."

[sub_resource type="Resource" id="Resource_6hkcd"]
resource_name = "Revive"
script = ExtResource("3_ea8sw")
objective = "A hunter faints when the ghost grabs them. Try shining your light on the downed hunter to fill their revive meter and revive them."

[sub_resource type="Resource" id="Resource_0chku"]
resource_name = "Teamwork2"
script = ExtResource("3_ea8sw")
objective = "Teamwork is essential, but there is no in-game way to talk (yet). [pulse freq=2.0 color=#ffffff7f ease=-2.0]Try using a voice chat for the best experience.[/pulse]"

[sub_resource type="Resource" id="Resource_yqccr"]
resource_name = "Complete"
script = ExtResource("3_ea8sw")
objective = "[rainbow freq=0.6 sat=0.6 val=1]Tutorial complete. Happy hunting![/rainbow]"

[sub_resource type="Resource" id="Resource_xh0tf"]
resource_local_to_scene = true
resource_name = "IsMoving"
script = ExtResource("4_mx0qj")
expression = "is_moving"

[sub_resource type="Resource" id="Resource_nwmwq"]
resource_local_to_scene = true
resource_name = "Not"
script = ExtResource("5_h1wiw")
guard = SubResource("Resource_xh0tf")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_ol48q"]
resource_local_to_scene = true
shader = ExtResource("6_6k6h6")
shader_parameter/old_palette = ExtResource("13_k4uj5")
shader_parameter/new_palette = ExtResource("7_k04wc")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_ar6y6"]
resource_local_to_scene = true
shader = ExtResource("6_6k6h6")
shader_parameter/old_palette = ExtResource("14_xh0tf")
shader_parameter/new_palette = ExtResource("14_xh0tf")

[sub_resource type="Resource" id="Resource_1gg0e"]
resource_local_to_scene = true
resource_name = "IsMoving"
script = ExtResource("4_mx0qj")
expression = "is_moving"

[sub_resource type="Resource" id="Resource_v6gpo"]
resource_local_to_scene = true
resource_name = "IsMoving"
script = ExtResource("4_mx0qj")
expression = "is_moving"

[sub_resource type="Resource" id="Resource_dfwv5"]
resource_local_to_scene = true
resource_name = "Not"
script = ExtResource("5_h1wiw")
guard = SubResource("Resource_v6gpo")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_6xxlw"]
resource_local_to_scene = true
shader = ExtResource("6_6k6h6")
shader_parameter/old_palette = ExtResource("13_k4uj5")
shader_parameter/new_palette = ExtResource("7_k04wc")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_ltsrr"]
resource_local_to_scene = true
shader = ExtResource("6_6k6h6")
shader_parameter/old_palette = ExtResource("14_xh0tf")
shader_parameter/new_palette = ExtResource("14_xh0tf")

[node name="Tutorial" unique_id=801845497 instance=ExtResource("1_c5qxs")]
script = ExtResource("2_v1ay4")
battery_quest = SubResource("Resource_7jipr")
quests = Array[ExtResource("3_ea8sw")]([SubResource("Resource_26eav"), SubResource("Resource_f0tmj"), SubResource("Resource_y74n0"), SubResource("Resource_hsvyu"), SubResource("Resource_pl133"), SubResource("Resource_04vwp"), SubResource("Resource_s3q2n"), SubResource("Resource_7jipr"), SubResource("Resource_6hkcd"), SubResource("Resource_0chku"), SubResource("Resource_yqccr")])
play_complete_sound = Array[ExtResource("3_ea8sw")]([SubResource("Resource_f0tmj"), SubResource("Resource_y74n0"), SubResource("Resource_pl133"), SubResource("Resource_04vwp"), SubResource("Resource_s3q2n"), SubResource("Resource_7jipr"), SubResource("Resource_6hkcd")])

[node name="Welcome" parent="QuestNodes" parent_id_path=PackedInt32Array(89701128) index="0" unique_id=212941630 instance=ExtResource("3_0femm")]
quest = SubResource("Resource_26eav")

[node name="Move" parent="QuestNodes" parent_id_path=PackedInt32Array(89701128) index="1" unique_id=599038518 instance=ExtResource("4_dj2kv")]
quest = SubResource("Resource_f0tmj")
delay = 0.5

[node name="Light" parent="QuestNodes" parent_id_path=PackedInt32Array(89701128) index="2" unique_id=349650046 instance=ExtResource("4_dj2kv")]
quest = SubResource("Resource_y74n0")
delay = 0.5

[node name="AlertInfo" parent="QuestNodes" parent_id_path=PackedInt32Array(89701128) index="3" unique_id=396621035 instance=ExtResource("3_0femm")]
quest = SubResource("Resource_hsvyu")
words_per_minute = 300.0

[node name="AlertLow" type="Node" parent="QuestNodes" parent_id_path=PackedInt32Array(89701128) index="4" unique_id=1855659562]
script = ExtResource("5_sx67b")
quest = SubResource("Resource_blp0j")

[node name="AlertHigh" type="Node" parent="QuestNodes" parent_id_path=PackedInt32Array(89701128) index="5" unique_id=1205829281]
script = ExtResource("5_sx67b")
quest = SubResource("Resource_huau8")

[node name="Damage" type="Node" parent="QuestNodes" parent_id_path=PackedInt32Array(89701128) index="6" unique_id=919109529]
script = ExtResource("5_sx67b")
quest = SubResource("Resource_04vwp")

[node name="Summon" type="Node" parent="QuestNodes" parent_id_path=PackedInt32Array(89701128) index="7" unique_id=1336881912]
script = ExtResource("5_sx67b")
quest = SubResource("Resource_s3q2n")

[node name="RetryTimer" type="Timer" parent="QuestNodes/Summon" index="0" unique_id=364913396]
wait_time = 7.0
one_shot = true

[node name="Battery" type="Node" parent="QuestNodes" parent_id_path=PackedInt32Array(89701128) index="8" unique_id=395080946]
script = ExtResource("5_sx67b")
quest = SubResource("Resource_7jipr")

[node name="Revive" type="Node" parent="QuestNodes" parent_id_path=PackedInt32Array(89701128) index="9" unique_id=271870575]
script = ExtResource("5_sx67b")
quest = SubResource("Resource_6hkcd")

[node name="Teamwork" parent="QuestNodes" parent_id_path=PackedInt32Array(89701128) index="10" unique_id=1173197535 instance=ExtResource("3_0femm")]
quest = SubResource("Resource_0chku")

[node name="Sprint" parent="CanvasLayer/MarginContainer/PanelContainer/VBoxContainer/Prompts" parent_id_path=PackedInt32Array(993135915) index="2" unique_id=129483878]
text = "Light:"

[node name="Summon" parent="CanvasLayer/MarginContainer/PanelContainer/VBoxContainer/Prompts" parent_id_path=PackedInt32Array(993135915) index="4" unique_id=1745018194]
visible = false

[node name="Button2Prompt" parent="CanvasLayer/MarginContainer/PanelContainer/VBoxContainer/Prompts" parent_id_path=PackedInt32Array(993135915) index="5" unique_id=139347678]
visible = false

[node name="Ghost" parent="." index="5" unique_id=2108008753 node_paths=PackedStringArray("controller")]
position = Vector2(368, 128)
controller = NodePath("NPCGhost")

[node name="NPCGhost" parent="Ghost" index="18" unique_id=2098365836 instance=ExtResource("6_n7jug")]

[node name="FollowPlayer" parent="Ghost/IgnoreCanvasModulate" parent_id_path=PackedInt32Array(2108008753, 1772456436) index="0" unique_id=343564369]
position = Vector2(368, 128)

[node name="Hunter" parent="." index="6" unique_id=201539915]
position = Vector2(368, 248)

[node name="IsMoving" parent="Hunter/StateChart/Base/Alive/Movement/Idle" parent_id_path=PackedInt32Array(201539915, 339987996) index="0" unique_id=690856688]
guard = SubResource("Resource_xh0tf")

[node name="IsNotMoving" parent="Hunter/StateChart/Base/Alive/Movement/Move" parent_id_path=PackedInt32Array(201539915, 1270144949) index="0" unique_id=713585796]
guard = SubResource("Resource_nwmwq")

[node name="MaterialParent" parent="Hunter/HunterCostume/CanvasGroup" parent_id_path=PackedInt32Array(201539915, 1831305852, 443637965) index="0" unique_id=348678599]
material = SubResource("ShaderMaterial_ol48q")

[node name="Hat" parent="Hunter/HunterCostume/CanvasGroup" parent_id_path=PackedInt32Array(201539915, 1831305852, 443637965) index="1" unique_id=868655723]
material = SubResource("ShaderMaterial_ar6y6")

[node name="FollowPlayer" parent="Hunter/IgnoreCanvasModulate" parent_id_path=PackedInt32Array(201539915, 1683814156) index="0" unique_id=1940306715]
position = Vector2(368, 248)

[node name="BatterySpawner" parent="." index="7" unique_id=1035666342 node_paths=PackedStringArray("spawn_root") instance=ExtResource("13_g4mwu")]
spawn_root = NodePath("..")

[node name="NPCHunter" parent="." index="8" unique_id=521220052 node_paths=PackedStringArray("controller") instance=ExtResource("7_smdw1")]
position = Vector2(136, 127)
controller = NodePath("NPCHunter")
metadata/_edit_group_ = true

[node name="IsMoving" parent="NPCHunter/StateChart/Base/Alive/Movement/Idle" parent_id_path=PackedInt32Array(521220052, 339987996) index="0" unique_id=690856688]
guard = SubResource("Resource_1gg0e")

[node name="IsNotMoving" parent="NPCHunter/StateChart/Base/Alive/Movement/Move" parent_id_path=PackedInt32Array(521220052, 1270144949) index="0" unique_id=713585796]
guard = SubResource("Resource_dfwv5")

[node name="HunterCostume" parent="NPCHunter" index="13" unique_id=1831305852]
palette = 1

[node name="MaterialParent" parent="NPCHunter/HunterCostume/CanvasGroup" parent_id_path=PackedInt32Array(521220052, 1831305852, 443637965) index="0" unique_id=348678599]
material = SubResource("ShaderMaterial_6xxlw")

[node name="Hat" parent="NPCHunter/HunterCostume/CanvasGroup" parent_id_path=PackedInt32Array(521220052, 1831305852, 443637965) index="1" unique_id=868655723]
material = SubResource("ShaderMaterial_ltsrr")

[node name="FollowPlayer" parent="NPCHunter/IgnoreCanvasModulate" parent_id_path=PackedInt32Array(521220052, 1683814156) index="0" unique_id=1940306715]
position = Vector2(136, 127)

[node name="NPCHunter" parent="NPCHunter" index="17" unique_id=935499562 node_paths=PackedStringArray("ghost") instance=ExtResource("8_40hbx")]
ghost = NodePath("../../Ghost")

[connection signal="completed" from="QuestNodes/Damage" to="Ghost/NPCGhost" method="set_sprint" binds= [true]]
[connection signal="started" from="QuestNodes/Damage" to="Ghost" method="hide"]
[connection signal="started" from="QuestNodes/Damage" to="Ghost" method="set_position" binds= [Vector2(192, 288)]]
[connection signal="started" from="QuestNodes/Damage" to="Ghost/NPCGhost" method="set_sprint" binds= [false]]
[connection signal="completed" from="QuestNodes/Summon" to="QuestNodes/Summon/RetryTimer" method="stop"]
[connection signal="completed" from="QuestNodes/Summon" to="Ghost/NPCGhost" method="set_summon" binds= [false]]
[connection signal="completed" from="QuestNodes/Summon" to="Ghost/NPCGhost" method="set_sprint" binds= [true]]
[connection signal="started" from="QuestNodes/Summon" to="Ghost" method="set_position" binds= [Vector2(368, 128)]]
[connection signal="started" from="QuestNodes/Summon" to="Ghost/NPCGhost" method="set_summon" binds= [true]]
[connection signal="started" from="QuestNodes/Summon" to="Ghost/NPCGhost" method="set_sprint" binds= [false]]
[connection signal="timeout" from="QuestNodes/Summon/RetryTimer" to="Ghost/NPCGhost" method="set_summon" binds= [true]]
[connection signal="completed" from="QuestNodes/Battery" to="Hunter/StateChart/Base/Dead/Revived" method="set_block_signals" binds= [false]]
[connection signal="started" from="QuestNodes/Battery" to="Hunter/StateChart/Base/Dead/Revived" method="set_block_signals" binds= [true]]
[connection signal="started" from="QuestNodes/Revive" to="Ghost" method="set_position" binds= [Vector2(112, 127)]]
[connection signal="ready" from="Ghost" to="Ghost/NPCGhost" method="set_sprint" flags=3 binds= [true]]
[connection signal="charged" from="Ghost/Summon" to="Ghost/NPCGhost" method="set_summon" binds= [false]]
[connection signal="summoned" from="Ghost/Summon" to="QuestNodes/Summon/RetryTimer" method="start"]
[connection signal="state_entered" from="Ghost/StateChart/Base/Behavior/Dead" to="." method="revive_ghost"]
[connection signal="state_entered" from="Ghost/StateChart/Base/Animation/Move" to="QuestNodes/Move" method="start"]
[connection signal="state_exited" from="Ghost/StateChart/Base/Animation/Move" to="QuestNodes/Move" method="stop"]
[connection signal="state_entered" from="Ghost/StateChart/Base/Animation/Sprint" to="QuestNodes/Move" method="start"]
[connection signal="state_entered" from="Ghost/StateChart/Base/Animation/Sprint" to="QuestNodes/Light" method="start"]
[connection signal="state_exited" from="Ghost/StateChart/Base/Animation/Sprint" to="QuestNodes/Move" method="stop"]
[connection signal="state_exited" from="Ghost/StateChart/Base/Animation/Sprint" to="QuestNodes/Light" method="stop"]
[connection signal="state_entered" from="Ghost/StateChart/Base/Animation/Panic" to="QuestNodes/Move" method="start"]
[connection signal="state_exited" from="Ghost/StateChart/Base/Animation/Panic" to="QuestNodes/Move" method="stop"]
[connection signal="damage_taken" from="Ghost/DamageSignals" to="QuestNodes/Damage" method="complete"]
[connection signal="dropped" from="Hunter" to="HunterReviveTimer" method="start"]
[connection signal="state_entered" from="Hunter/StateChart/Base/Alive/Movement/Move" to="QuestNodes/Move" method="start"]
[connection signal="state_exited" from="Hunter/StateChart/Base/Alive/Movement/Move" to="QuestNodes/Move" method="stop"]
[connection signal="damage_taken" from="Hunter/Flashlight/Behavior" to="QuestNodes/Summon" method="complete"]
[connection signal="powered_off" from="Hunter/Flashlight/Behavior" to="QuestNodes/Light" method="stop"]
[connection signal="powered_on" from="Hunter/Flashlight/Behavior" to="QuestNodes/Light" method="start"]
[connection signal="alerted_high" from="Hunter/IgnoreCanvasModulate/FollowPlayer/NotificationContainer/Alert" to="QuestNodes/AlertHigh" method="complete"]
[connection signal="alerted_low" from="Hunter/IgnoreCanvasModulate/FollowPlayer/NotificationContainer/Alert" to="QuestNodes/AlertLow" method="complete"]
[connection signal="battery_spawned" from="BatterySpawner" to="." method="_on_battery_spawned"]
[connection signal="dropped" from="NPCHunter" to="Ghost" method="set_position" binds= [Vector2(368, 128)]]
[connection signal="revived" from="NPCHunter/DamageSignals/Revivable" to="QuestNodes/Revive" method="complete"]

[editable path="Ghost"]
[editable path="Ghost/PlayerControllerStack"]
[editable path="Hunter"]
[editable path="Hunter/HeartbeatRumble"]
[editable path="Hunter/PlayerControllerStack"]
[editable path="Hunter/Flashlight"]
[editable path="Hunter/Flashlight/Display"]
[editable path="Hunter/HunterCostume"]
[editable path="Hunter/IgnoreCanvasModulate/FollowPlayer/NotificationContainer/Alert"]
[editable path="Hunter/IgnoreCanvasModulate/FollowPlayer/NotificationContainer/BatteryAlert"]
[editable path="NPCHunter"]
[editable path="NPCHunter/HeartbeatRumble"]
[editable path="NPCHunter/PlayerControllerStack"]
[editable path="NPCHunter/Flashlight"]
[editable path="NPCHunter/Flashlight/Display"]
[editable path="NPCHunter/HunterCostume"]
[editable path="NPCHunter/IgnoreCanvasModulate/FollowPlayer/NotificationContainer/Alert"]
[editable path="NPCHunter/IgnoreCanvasModulate/FollowPlayer/NotificationContainer/BatteryAlert"]
